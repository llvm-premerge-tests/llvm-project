; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 2
; RUN: opt < %s -passes=infer-alignment -S | FileCheck %s
target triple = "x86_64-unknown-linux-gnu"

define i32 @load(ptr align 32 %a) {
; CHECK-LABEL: define i32 @load
; CHECK-SAME: (ptr align 32 [[A:%.*]]) {
; CHECK-NEXT:    [[TMP1:%.*]] = load i32, ptr [[A]], align 32
; CHECK-NEXT:    ret i32 [[TMP1]]
;
  %1 = load i32, ptr %a, align 4
  ret i32 %1
}

define i32 @load_through_call(ptr align 32 %a) {
; CHECK-LABEL: define i32 @load_through_call
; CHECK-SAME: (ptr align 32 [[A:%.*]]) {
; CHECK-NEXT:    [[V:%.*]] = call ptr @func1(ptr [[A]])
; CHECK-NEXT:    [[TMP1:%.*]] = load i32, ptr [[V]], align 32
; CHECK-NEXT:    ret i32 [[TMP1]]
;
  %v = call ptr @func1(ptr %a)
  %1 = load i32, ptr %v, align 4
  ret i32 %1
}

declare ptr @func1(ptr returned) nounwind
